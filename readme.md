# Лаб3. Ansible part 2 (Ansible advanced)

Написать ansible-плейбук, который на целевых хостах:

- устанавливает сканер NMAP
- копирует файл со списком целей для сканирования
- запускает NMAP и сканирует цели (по портам 80 и 443)
- cобирает результаты сканирования (stdout)
- выводит результаты сканирования

# Лог выполнения задания:

1. Создаем на управляющей машине инвентарь inventory.ini. В нем определяем группу хостов [scanners] - управляемые ansible-ом виртуальные машины (целевые хосты), которые и будут сканировать цели с помощью nmap

2. Для проверки того что ansible управляющей машины нормально имеет доступ к управляющим машинам, можно разово использовать такую команду:
> ansible -m ping -i inventory.yml scanners (пропингуй хосты группы scanners)

3. Создаем плейбук с тасками playbook.yml. 
Первая таска - убеждаемся что nmap установлен на сканирующих хостах, устанавливаем если нет. 
Вторая - само сканирование с регистрацией результатов в переменную scan_results. Применяется Jinja2 шаблон - команда lookup('file', './targets.txt').splitlines() читает файл, разделяет построчно.
Третья - вывод результатов. Вместо объемного вывода scan_results мы пробегаемся циклом по списку элементов в поле с ключем "results" и выводим для каждого элемента только поле с ключем "stdout_lines" (в этом поле часто содержится более сжатая информация).

Запускаем плейбук:
> ansible-playbook playbook.yml -i inventory.yml


